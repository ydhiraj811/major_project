import{p as Fe,u as Pe}from"./index-df998e04.js";import"./Index-3441375f.js";const{SvelteComponent:Se,append:v,attr:T,detach:$,element:z,flush:B,init:Ce,insert:ee,noop:V,safe_not_equal:Te,set_data:I,set_style:G,space:H,text:W,toggle_class:X}=window.__gradio__svelte__internal,{onMount:ze,createEventDispatcher:De,getContext:We}=window.__gradio__svelte__internal;function Y(t){let e,n,l,r,o=q(t[2])+"",f,d,s,a,h=t[2].orig_name+"",g;return{c(){e=z("div"),n=z("span"),l=z("div"),r=z("progress"),f=W(o),s=H(),a=z("span"),g=W(h),G(r,"visibility","hidden"),G(r,"height","0"),G(r,"width","0"),r.value=d=q(t[2]),T(r,"max","100"),T(r,"class","svelte-1vsfomn"),T(l,"class","progress-bar svelte-1vsfomn"),T(a,"class","file-name svelte-1vsfomn"),T(e,"class","file svelte-1vsfomn")},m(c,_){ee(c,e,_),v(e,n),v(n,l),v(l,r),v(r,f),v(e,s),v(e,a),v(a,g)},p(c,_){_&4&&o!==(o=q(c[2])+"")&&I(f,o),_&4&&d!==(d=q(c[2]))&&(r.value=d),_&4&&h!==(h=c[2].orig_name+"")&&I(g,h)},d(c){c&&$(e)}}}function je(t){let e,n,l,r=t[0].length+"",o,f,d=t[0].length>1?"files":"file",s,a,h,g=t[2]&&Y(t);return{c(){e=z("div"),n=z("span"),l=W("Uploading "),o=W(r),f=H(),s=W(d),a=W("..."),h=H(),g&&g.c(),T(n,"class","uploading svelte-1vsfomn"),T(e,"class","wrap svelte-1vsfomn"),X(e,"progress",t[1])},m(c,_){ee(c,e,_),v(e,n),v(n,l),v(n,o),v(n,f),v(n,s),v(n,a),v(e,h),g&&g.m(e,null)},p(c,[_]){_&1&&r!==(r=c[0].length+"")&&I(o,r),_&1&&d!==(d=c[0].length>1?"files":"file")&&I(s,d),c[2]?g?g.p(c,_):(g=Y(c),g.c(),g.m(e,null)):g&&(g.d(1),g=null),_&2&&X(e,"progress",c[1])},i:V,o:V,d(c){c&&$(e),g&&g.d()}}}function q(t){return t.progress*100/(t.size||0)||0}function qe(t){let e=0;return t.forEach(n=>{e+=q(n)}),document.documentElement.style.setProperty("--upload-progress-width",(e/t.length).toFixed(2)+"%"),e/t.length}function Me(t,e,n){let{upload_id:l}=e,{root:r}=e,{files:o}=e,f,d=!1,s,a,h=o.map(u=>({...u,progress:0}));const g=De();function c(u,p){n(0,h=h.map(w=>(w.orig_name===u&&(w.progress+=p),w)))}const _=We("EventSource_factory");return ze(()=>{f=_(new URL(`${r}/upload_progress?upload_id=${l}`)),f.onmessage=async function(u){const p=JSON.parse(u.data);d||n(1,d=!0),p.msg==="done"?(f.close(),g("done")):(n(6,s=p),c(p.orig_name,p.chunk_size))}}),t.$$set=u=>{"upload_id"in u&&n(3,l=u.upload_id),"root"in u&&n(4,r=u.root),"files"in u&&n(5,o=u.files)},t.$$.update=()=>{t.$$.dirty&1&&qe(h),t.$$.dirty&65&&n(2,a=s||h[0])},[h,d,a,l,r,o,s]}class Ne extends Se{constructor(e){super(),Ce(this,e,Me,je,Te,{upload_id:3,root:4,files:5})}get upload_id(){return this.$$.ctx[3]}set upload_id(e){this.$$set({upload_id:e}),B()}get root(){return this.$$.ctx[4]}set root(e){this.$$set({root:e}),B()}get files(){return this.$$.ctx[5]}set files(e){this.$$set({files:e}),B()}}const{SvelteComponent:Ie,append:Z,attr:y,binding_callbacks:Je,bubble:P,check_outros:te,create_component:Le,create_slot:le,destroy_component:Oe,detach:J,element:K,empty:ne,flush:A,get_all_dirty_from_scope:ie,get_slot_changes:re,group_outros:se,init:Re,insert:L,listen:k,mount_component:Be,prevent_default:S,run_all:Ge,safe_not_equal:He,set_style:oe,space:Ke,stop_propagation:C,toggle_class:m,transition_in:F,transition_out:D,update_slot_base:ae}=window.__gradio__svelte__internal,{createEventDispatcher:Qe,tick:Ve,getContext:Xe}=window.__gradio__svelte__internal;function Ye(t){let e,n,l,r,o,f,d,s,a,h,g;const c=t[22].default,_=le(c,t,t[21],null);return{c(){e=K("button"),_&&_.c(),n=Ke(),l=K("input"),y(l,"aria-label","file upload"),y(l,"data-testid","file-upload"),y(l,"type","file"),y(l,"accept",r=t[14]||void 0),l.multiple=o=t[6]==="multiple"||void 0,y(l,"webkitdirectory",f=t[6]==="directory"||void 0),y(l,"mozdirectory",d=t[6]==="directory"||void 0),y(l,"class","svelte-j5bxrl"),y(e,"tabindex",s=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),m(e,"hidden",t[9]),m(e,"center",t[4]),m(e,"boundedheight",t[3]),m(e,"flex",t[5]),m(e,"disable_click",t[7]),oe(e,"height","100%")},m(u,p){L(u,e,p),_&&_.m(e,null),Z(e,n),Z(e,l),t[30](l),a=!0,h||(g=[k(l,"change",t[16]),k(e,"drag",C(S(t[23]))),k(e,"dragstart",C(S(t[24]))),k(e,"dragend",C(S(t[25]))),k(e,"dragover",C(S(t[26]))),k(e,"dragenter",C(S(t[27]))),k(e,"dragleave",C(S(t[28]))),k(e,"drop",C(S(t[29]))),k(e,"click",t[11]),k(e,"drop",t[17]),k(e,"dragenter",t[15]),k(e,"dragleave",t[15])],h=!0)},p(u,p){_&&_.p&&(!a||p[0]&2097152)&&ae(_,c,u,u[21],a?re(c,u[21],p,null):ie(u[21]),null),(!a||p[0]&16384&&r!==(r=u[14]||void 0))&&y(l,"accept",r),(!a||p[0]&64&&o!==(o=u[6]==="multiple"||void 0))&&(l.multiple=o),(!a||p[0]&64&&f!==(f=u[6]==="directory"||void 0))&&y(l,"webkitdirectory",f),(!a||p[0]&64&&d!==(d=u[6]==="directory"||void 0))&&y(l,"mozdirectory",d),(!a||p[0]&512&&s!==(s=u[9]?-1:0))&&y(e,"tabindex",s),(!a||p[0]&512)&&m(e,"hidden",u[9]),(!a||p[0]&16)&&m(e,"center",u[4]),(!a||p[0]&8)&&m(e,"boundedheight",u[3]),(!a||p[0]&32)&&m(e,"flex",u[5]),(!a||p[0]&128)&&m(e,"disable_click",u[7])},i(u){a||(F(_,u),a=!0)},o(u){D(_,u),a=!1},d(u){u&&J(e),_&&_.d(u),t[30](null),h=!1,Ge(g)}}}function Ze(t){let e,n,l=!t[9]&&x(t);return{c(){l&&l.c(),e=ne()},m(r,o){l&&l.m(r,o),L(r,e,o),n=!0},p(r,o){r[9]?l&&(se(),D(l,1,1,()=>{l=null}),te()):l?(l.p(r,o),o[0]&512&&F(l,1)):(l=x(r),l.c(),F(l,1),l.m(e.parentNode,e))},i(r){n||(F(l),n=!0)},o(r){D(l),n=!1},d(r){r&&J(e),l&&l.d(r)}}}function xe(t){let e,n,l,r,o;const f=t[22].default,d=le(f,t,t[21],null);return{c(){e=K("button"),d&&d.c(),y(e,"tabindex",n=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),m(e,"hidden",t[9]),m(e,"center",t[4]),m(e,"boundedheight",t[3]),m(e,"flex",t[5]),oe(e,"height","100%")},m(s,a){L(s,e,a),d&&d.m(e,null),l=!0,r||(o=k(e,"click",t[10]),r=!0)},p(s,a){d&&d.p&&(!l||a[0]&2097152)&&ae(d,f,s,s[21],l?re(f,s[21],a,null):ie(s[21]),null),(!l||a[0]&512&&n!==(n=s[9]?-1:0))&&y(e,"tabindex",n),(!l||a[0]&512)&&m(e,"hidden",s[9]),(!l||a[0]&16)&&m(e,"center",s[4]),(!l||a[0]&8)&&m(e,"boundedheight",s[3]),(!l||a[0]&32)&&m(e,"flex",s[5])},i(s){l||(F(d,s),l=!0)},o(s){D(d,s),l=!1},d(s){s&&J(e),d&&d.d(s),r=!1,o()}}}function x(t){let e,n;return e=new Ne({props:{root:t[8],upload_id:t[12],files:t[13]}}),{c(){Le(e.$$.fragment)},m(l,r){Be(e,l,r),n=!0},p(l,r){const o={};r[0]&256&&(o.root=l[8]),r[0]&4096&&(o.upload_id=l[12]),r[0]&8192&&(o.files=l[13]),e.$set(o)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Oe(e,l)}}}function $e(t){let e,n,l,r;const o=[xe,Ze,Ye],f=[];function d(s,a){return s[0]==="clipboard"?0:s[1]&&!s[2]?1:2}return e=d(t),n=f[e]=o[e](t),{c(){n.c(),l=ne()},m(s,a){f[e].m(s,a),L(s,l,a),r=!0},p(s,a){let h=e;e=d(s),e===h?f[e].p(s,a):(se(),D(f[h],1,1,()=>{f[h]=null}),te(),n=f[e],n?n.p(s,a):(n=f[e]=o[e](s),n.c()),F(n,1),n.m(l.parentNode,l))},i(s){r||(F(n),r=!0)},o(s){D(n),r=!1},d(s){s&&J(l),f[e].d(s)}}}function et(t,e,n){if(!t||t==="*"||t==="file/*"||Array.isArray(t)&&t.some(r=>r==="*"||r==="file/*"))return!0;let l;if(typeof t=="string")l=t.split(",").map(r=>r.trim());else if(Array.isArray(t))l=t;else return!1;return l.includes(e)||l.some(r=>{const[o]=r.split("/").map(f=>f.trim());return r.endsWith("/*")&&n.startsWith(o+"/")})}function tt(t,e,n){let{$$slots:l={},$$scope:r}=e,{filetype:o=null}=e,{dragging:f=!1}=e,{boundedheight:d=!0}=e,{center:s=!0}=e,{flex:a=!0}=e,{file_count:h="single"}=e,{disable_click:g=!1}=e,{root:c}=e,{hidden:_=!1}=e,{format:u="file"}=e,{uploading:p=!1}=e,{hidden_upload:w=null}=e,O,R,j;const ue=Xe("upload_files"),M=Qe(),fe=["image","video","audio","text","file"],Q=i=>i.startsWith(".")||i.endsWith("/*")?i:fe.includes(i)?i+"/*":"."+i;function de(){n(18,f=!f)}function _e(){navigator.clipboard.read().then(async i=>{for(let b=0;b<i.length;b++){const U=i[b].types.find(E=>E.startsWith("image/"));if(U){i[b].getType(U).then(async E=>{const Ee=new File([E],`clipboard.${U.replace("image/","")}`);await N([Ee])});break}}})}function ce(){g||w&&(n(2,w.value="",w),w.click())}async function ge(i){await Ve(),n(12,O=Math.random().toString(36).substring(2,15)),n(1,p=!0);const b=await Pe(i,c,O,ue);return M("load",h==="single"?b?.[0]:b),n(1,p=!1),b||[]}async function N(i){if(!i.length)return;let b=i.map(U=>new File([U],U.name,{type:U.type}));return n(13,R=await Fe(b)),await ge(R)}async function he(i){const b=i.target;if(b.files)if(u!="blob")await N(Array.from(b.files));else{if(h==="single"){M("load",b.files[0]);return}M("load",b.files)}}async function pe(i){if(n(18,f=!1),!i.dataTransfer?.files)return;const b=Array.from(i.dataTransfer.files).filter(U=>{const E="."+U.name.split(".").pop();return E&&et(j,E,U.type)||(E&&Array.isArray(o)?o.includes(E):E===o)?!0:(M("error",`Invalid file type only ${o} allowed.`),!1)});await N(b)}function me(i){P.call(this,t,i)}function be(i){P.call(this,t,i)}function ye(i){P.call(this,t,i)}function ve(i){P.call(this,t,i)}function ke(i){P.call(this,t,i)}function we(i){P.call(this,t,i)}function Ae(i){P.call(this,t,i)}function Ue(i){Je[i?"unshift":"push"](()=>{w=i,n(2,w)})}return t.$$set=i=>{"filetype"in i&&n(0,o=i.filetype),"dragging"in i&&n(18,f=i.dragging),"boundedheight"in i&&n(3,d=i.boundedheight),"center"in i&&n(4,s=i.center),"flex"in i&&n(5,a=i.flex),"file_count"in i&&n(6,h=i.file_count),"disable_click"in i&&n(7,g=i.disable_click),"root"in i&&n(8,c=i.root),"hidden"in i&&n(9,_=i.hidden),"format"in i&&n(19,u=i.format),"uploading"in i&&n(1,p=i.uploading),"hidden_upload"in i&&n(2,w=i.hidden_upload),"$$scope"in i&&n(21,r=i.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&(o==null?n(14,j=null):typeof o=="string"?n(14,j=Q(o)):(n(0,o=o.map(Q)),n(14,j=o.join(", "))))},[o,p,w,d,s,a,h,g,c,_,_e,ce,O,R,j,de,he,pe,f,u,N,r,l,me,be,ye,ve,ke,we,Ae,Ue]}class it extends Ie{constructor(e){super(),Re(this,e,tt,$e,He,{filetype:0,dragging:18,boundedheight:3,center:4,flex:5,file_count:6,disable_click:7,root:8,hidden:9,format:19,uploading:1,hidden_upload:2,paste_clipboard:10,open_file_upload:11,load_files:20},null,[-1,-1])}get filetype(){return this.$$.ctx[0]}set filetype(e){this.$$set({filetype:e}),A()}get dragging(){return this.$$.ctx[18]}set dragging(e){this.$$set({dragging:e}),A()}get boundedheight(){return this.$$.ctx[3]}set boundedheight(e){this.$$set({boundedheight:e}),A()}get center(){return this.$$.ctx[4]}set center(e){this.$$set({center:e}),A()}get flex(){return this.$$.ctx[5]}set flex(e){this.$$set({flex:e}),A()}get file_count(){return this.$$.ctx[6]}set file_count(e){this.$$set({file_count:e}),A()}get disable_click(){return this.$$.ctx[7]}set disable_click(e){this.$$set({disable_click:e}),A()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),A()}get hidden(){return this.$$.ctx[9]}set hidden(e){this.$$set({hidden:e}),A()}get format(){return this.$$.ctx[19]}set format(e){this.$$set({format:e}),A()}get uploading(){return this.$$.ctx[1]}set uploading(e){this.$$set({uploading:e}),A()}get hidden_upload(){return this.$$.ctx[2]}set hidden_upload(e){this.$$set({hidden_upload:e}),A()}get paste_clipboard(){return this.$$.ctx[10]}get open_file_upload(){return this.$$.ctx[11]}get load_files(){return this.$$.ctx[20]}}export{it as U};
//# sourceMappingURL=ModifyUpload.svelte_svelte_type_style_lang-999f7850.js.map
